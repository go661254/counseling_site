# 予約管理アプリ

## 概要
FlaskとSQLiteを使用したシンプルな予約管理アプリです。  
予約の作成・一覧表示・編集・削除・カレンダー表示が可能です。  
ログイン機能（セッション管理）付きで、認証されたユーザーのみアクセス可能です。

---

## 機能一覧
- ユーザー認証（ログイン/ログアウト）
- 予約作成フォーム
- 予約内容確認ページ
- 完了ページ
- 予約一覧表示（名前・日付・時間）
- 予約編集機能
- 予約削除機能
- 予約検索（名前・日付）
- カレンダー表示（予約付きの日を表示）

---

## 必要環境
- Python 3.10以上
- Flask
- SQLite3（Python標準搭載）

---

## インストール方法
1. このリポジトリをダウンロードまたはクローン
2. 必要なライブラリをインストール
    ```bash
    pip install flask
    ```
3. データベースを初期化（初回のみ）
    ```bash
    python init_db.py
    ```
4. アプリを起動
    ```bash
    python app.py
    ```
5. ブラウザで以下にアクセス
    ```
    http://127.0.0.1:5000
    ```

---

## ディレクトリ構造
project/
├── app.py # Flaskアプリのエントリポイント
├── db.py # DB接続や操作用関数
├── main_routes.py # メイン機能のルーティング
├── calendar_routes.py # カレンダー機能のルーティング
├── init_db.py # DB初期化スクリプト
├── templates/ # HTMLテンプレート
│ ├── index.html
│ ├── login.html
│ ├── confirm.html
│ ├── complete.html
│ ├── list.html
│ ├── edit.html
│ └── calendar.html
└── static/ # CSSや画像
└── style.css

---

## データベース仕様
**テーブル名:** `reservations`

| カラム名 | 型      | 説明       |
|----------|--------|------------|
| id       | INTEGER | 主キー     |
| name     | TEXT    | 予約者名   |
| date     | TEXT    | 予約日     |
| time     | TEXT    | 予約時間   |

---

## 使用例
1. `/login` からログイン
2. トップページで予約フォームに入力
3. 内容を確認して登録
4. 一覧ページまたはカレンダーで予約を確認
5. 必要に応じて編集・削除

---

## テストケース

### ログイン機能

| No | 項目 | 入力 | 期待結果 | 種類 |
|----|------|------|-----------|------|
| 1 | 正しいユーザー名・パスワードでログイン | ユーザー名: `admin` パスワード: `password123` | ログイン成功、トップページに遷移 | 正常系 |
| 2 | 間違ったユーザー名 | ユーザー名: `wrong` パスワード: `password123` | エラーメッセージ表示 | 異常系 |
| 3 | 間違ったパスワード | ユーザー名: `admin` パスワード: `wrong` | エラーメッセージ表示 | 異常系 |
| 4 | 未入力 | ユーザー名: 空 パスワード: 空 | HTML側で必須入力チェック、送信不可 | 異常系 |
| 5 | 未ログイン状態で `/list` にアクセス | なし | 自動で `/login` にリダイレクト | セキュリティ系 |
| 6 | ログアウト後に `/list` にアクセス | なし | 再び `/login` にリダイレクト | セキュリティ系 |

### 予約管理機能

| No | 項目 | 入力 | 期待結果 | 種類 |
|----|------|------|-----------|------|
| 1 | 正しい予約作成 | 名前: `山田太郎` 日付: `2025-09-10` 時間: `10:00` | 予約登録成功、確認ページ表示、一覧ページに追加 | 正常系 |
| 2 | 名前未入力 | 名前: 空 日付/時間: 正しい | エラーメッセージ「すべての項目を入力してください」 | 異常系 |
| 3 | 過去日時で予約 | 日付: 昨日 時間: 任意 | エラーメッセージ「過去の日時には予約できません」 | 異常系 |
| 4 | 同じ日時に重複予約 | 日付/時間: 既に予約済み | エラーメッセージ「すでに同じ日時に予約があります」 | 異常系 |
| 5 | 予約編集（正常系） | 既存予約の名前を変更 | 更新成功、一覧ページに反映 | 正常系 |
| 6 | 予約編集で重複日時 | 編集時に既存予約と同じ日時に変更 | エラーメッセージ「同じ日時に他の予約があります」 | 異常系 |
| 7 | 予約削除 | 削除ボタンをクリック | 予約が削除され一覧から消える | 正常系 |
| 8 | 日付検索 | 日付: `2025-09-10` | 指定日付の予約のみ表示 | 正常系 |
| 9 | 名前検索 | 名前: `山田` | 名前に「山田」を含む予約のみ表示 | 正常系 |
| 10 | ログイン必須チェック | 未ログインで `/list` 等にアクセス | 自動で `/login` にリダイレクト | セキュリティ系 |
| 11 | ログアウト後のアクセス | `/logout` 後に `/list` へアクセス | 再び `/login` にリダイレクト | セキュリティ系 |
